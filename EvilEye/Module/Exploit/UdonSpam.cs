using EvilEye.Events;
using System;
using System.Collections;
using System.Collections.Generic;
using MelonLoader;
using UnhollowerBaseLib;
using UnityEngine;
using VRC.Networking;
using EvilEye.SDK;

namespace EvilEye.Module.Exploit
{
    class UdonSpam : BaseModule
    {
        public static bool udonSpams;
        public UdonSpam() : base("Udon Spammer", "Spams Every Udon Object In The World", Main.Instance.exploistButton, null, true)
        {
        }
        public override void OnEnable()
        {
            LoggerUtill.Log("Udon Spammer Active", ConsoleColor.Green);
            udonSpams = true;
            MelonCoroutines.Start(this.UdonKill()); 
        }

        public override void OnDisable()
        {
            LoggerUtill.Log("Udon Spammer De-Activated", ConsoleColor.Red);
            udonSpams = false;
            MelonCoroutines.Stop(this.UdonKill());
        } 
        IEnumerator UdonKill()
        { 
            while (udonSpams)
            {
                Il2CppArrayBase<UdonSync> udonSyncs = UnityEngine.Object.FindObjectsOfType<UdonSync>();
                foreach (UdonSync uS in udonSyncs)
                {
                    uS.field_Public_UdonBehaviour_0.Interact();
                }
                IEnumerator<UdonSync> enumerator = null;
                yield return null;
                udonSyncs = null;
            }
            yield break;
        } 
    }
}
